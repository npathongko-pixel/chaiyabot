<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞: ‡πÅ‡∏ä‡∏ó‡∏ö‡∏≠‡∏ó‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; font-family: Arial, sans-serif; overflow: hidden; }

    /* üî• ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤ (‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å) */
    body {
      background:
        linear-gradient(180deg, rgba(250,243,224,0.75) 0%, rgba(251,248,232,0.75) 60%, rgba(224,202,143,0.85) 100%),
        url("wat-bg.webp") center/cover no-repeat fixed;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #leaf-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 1;
      overflow: hidden;
      pointer-events: none;
    }
    .leaf {
      position: absolute;
      top: -10%;
      z-index: 1;
      user-select: none;
      animation: falling-leaf 10s linear infinite;
    }
    @keyframes falling-leaf {
      0%   { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(120vh) rotate(720deg); opacity: 0; }
    }

    #content-wrapper {
      text-align: center;
      color: #5C4033;
      background: rgba(255, 255, 255, 0.85);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
      transition: opacity 0.5s ease, transform 0.5s ease;
      z-index: 2;
      position: relative;
    }
    #content-wrapper.hidden {
      opacity: 0;
      pointer-events: none;
      transform: scale(0.8);
    }

    /* ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏õ‡πá‡∏≠‡∏õ‡∏≠‡∏±‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‚Äì ‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏•‡∏¥‡∏õ) */
    #video-section {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 3;
      background: rgba(255, 255, 255, 0.96);
      border-radius: 20px;
      padding: 16px 18px 18px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);
      max-width: 340px;
      transition: all 0.5s ease;
      animation: slideInRight 0.8s ease-out;
    }
    #video-section.hidden {
      opacity: 0;
      transform: translateX(450px);
      pointer-events: none;
    }

    .close-video-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 35px;
      height: 35px;
      background: linear-gradient(135deg, #FF6B6B, #EE5A6F);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 20px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(255, 107, 107, 0.4);
      transition: all 0.3s ease;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }
    .close-video-btn:hover {
      transform: rotate(90deg) scale(1.1);
      box-shadow: 0 5px 15px rgba(255, 107, 107, 0.6);
    }

    .video-title {
      color: #5C4033;
      margin: 0 0 8px 0;
      font-size: 1.05em;
      text-align: left;
      border-bottom: 2px solid #D4AF37;
      padding-bottom: 6px;
    }
    .video-question {
      font-size: 0.9em;
      color: #7a5c35;
      margin: 6px 0 10px 0;
    }
    .open-video-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: #D4AF37;
      color: #5C4033;
      font-weight: bold;
      cursor: pointer;
      font-size: 0.9em;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.18);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    .open-video-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
    }

    #video-frame-wrapper {
      margin-top: 10px;
    }
    #video-frame-wrapper.video-collapsed {
      display: none;      /* ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
    }
    .video-frame-inner {
      position: relative;
      padding-bottom: 56.25%;  /* 16:9 */
      height: 0;
      overflow: hidden;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(212, 175, 55, 0.45);
      border: 3px solid #D4AF37;
    }
    .video-frame-inner iframe {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
    .video-caption {
      color: #8B6F47;
      font-size: 0.8em;
      margin: 6px 0 0 0;
      text-align: center;
      font-style: italic;
    }

    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(100px); }
      to   { opacity: 1; transform: translateX(0); }
    }

    @media (max-width: 768px) {
      #video-section {
        top: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
        padding: 15px;
      }
    }

    /* ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡πÉ‡∏´‡∏ç‡πà (‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î) */
    #nong-srivi-model {
      width: 180px;
      height: 180px;
      margin: 0 auto 20px auto;
      position: relative;
      animation: float 6s ease-in-out infinite;
    }
    .character-body {
      width: 120px;
      height: 140px;
      background: linear-gradient(135deg, #FFD700, #FFA500);
      border-radius: 50% 50% 60% 60%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
    }
    .character-head {
      width: 90px;
      height: 90px;
      background: linear-gradient(135deg, #FFE4B5, #FFDAB9);
      border-radius: 50%;
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    .character-eye {
      width: 12px;
      height: 12px;
      background: #2C1810;
      border-radius: 50%;
      position: absolute;
      top: 35px;
      animation: blink 3s infinite;
    }
    .character-eye.left  { left: 25px; }
    .character-eye.right { right: 25px; }
    @keyframes blink {
      0%, 48%, 52%, 100% { height: 12px; }
      50% { height: 2px; }
    }
    .character-smile {
      width: 30px;
      height: 15px;
      border: 3px solid #2C1810;
      border-top: none;
      border-radius: 0 0 30px 30px;
      position: absolute;
      top: 55px;
      left: 50%;
      transform: translateX(-50%);
    }

    @keyframes float {
      0%   { transform: translateY(0px); }
      50%  { transform: translateY(-20px); }
      100% { transform: translateY(0px); }
    }

    /* ‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡∏ö‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ä‡∏ó */
    #flying-srivi {
      position: fixed;
      width: 80px;
      height: 80px;
      z-index: 1000;
      pointer-events: none;
      display: none;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    #flying-srivi.flying {
      display: block;
      animation: fly-to-chat 2.5s cubic-bezier(0.68,-0.55,0.265,1.55) forwards;
    }
    @keyframes fly-to-chat {
      0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0) rotate(0deg);
      }
      20% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.2) rotate(180deg);
      }
      100% {
        opacity: 0.8;
        transform: translate(calc(50vw - 120px), calc(100vh - 140px)) scale(0.6) rotate(1080deg);
      }
    }
    .flying-character-body {
      width: 50px;
      height: 60px;
      background: linear-gradient(135deg, #FFD700, #FFA500);
      border-radius: 50% 50% 60% 60%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 5px 15px rgba(212, 175, 55, 0.5);
    }
    .flying-character-head {
      width: 45px;
      height: 45px;
      background: linear-gradient(135deg, #FFE4B5, #FFDAB9);
      border-radius: 50%;
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
    }
    .flying-character-eye {
      width: 6px;
      height: 6px;
      background: #2C1810;
      border-radius: 50%;
      position: absolute;
      top: 15px;
    }
    .flying-character-eye.left  { left: 12px; }
    .flying-character-eye.right { right: 12px; }
    .flying-character-smile {
      width: 15px;
      height: 8px;
      border: 2px solid #2C1810;
      border-top: none;
      border-radius: 0 0 15px 15px;
      position: absolute;
      top: 25px;
      left: 50%;
      transform: translateX(-50%);
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏ô‡∏ó‡∏ô‡∏≤ */
    #start-chat-button {
      background-color: #D4AF37;
      color: #5C4033;
      border: none;
      border-radius: 50px;
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      margin-top: 15px;
    }
    #start-chat-button:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 20px rgba(212, 175, 55, 0.5);
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö */
    #back-button {
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 5;
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      background: rgba(0,0,0,0.55);
      color: #fff;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      backdrop-filter: blur(6px);
    }
    #back-button:hover {
      background: rgba(0,0,0,0.8);
    }

    /* ‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡∏õ‡∏¥‡∏î‡∏ó‡∏±‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ä‡∏ó‡∏Ç‡∏≠‡∏á Dialogflow */
    #srivi-mini {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 64px;
      height: 64px;
      z-index: 2000;
      pointer-events: none;   /* ‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏∞‡∏•‡∏∏‡πÑ‡∏õ‡∏õ‡∏∏‡πà‡∏° Dialogflow ‡πÑ‡∏î‡πâ */
    }
    .srivi-mini-body {
      width: 42px;
      height: 48px;
      background: linear-gradient(135deg, #FFD700, #FFA500);
      border-radius: 50% 50% 60% 60%;
      position: absolute;
      bottom: 6px;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 0 4px 10px rgba(0,0,0,0.25);
      animation: mini-float 3s ease-in-out infinite;
    }
    .srivi-mini-head {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #FFE4B5, #FFDAB9);
      border-radius: 50%;
      position: absolute;
      bottom: 44px;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    }
    .srivi-mini-eye {
      width: 5px;
      height: 5px;
      background: #2C1810;
      border-radius: 50%;
      position: absolute;
      top: 14px;
      animation: blink 3s infinite;
    }
    .srivi-mini-eye.left  { left: 11px; }
    .srivi-mini-eye.right { right: 11px; }
    .srivi-mini-smile {
      width: 14px;
      height: 7px;
      border: 2px solid #2C1810;
      border-top: none;
      border-radius: 0 0 14px 14px;
      position: absolute;
      top: 23px;
      left: 50%;
      transform: translateX(-50%);
    }
    @keyframes mini-float {
      0%, 100% { transform: translate(-50%, 0); }
      50%      { transform: translate(-50%, -5px); }
    }

    /* ‡∏ò‡∏µ‡∏° Dialogflow Messenger */
    df-messenger {
      --df-messenger-header-background-color: linear-gradient(90deg,#0f7bdc,#35b3ff);
      --df-messenger-header-font-color: #ffffff;
      --df-messenger-user-message-background-color: #D4AF37;
      --df-messenger-user-message-font-color: #4C3F30;
      --df-messenger-chat-background-color: #FBF8E8;
      --df-messenger-bot-message: #ffffff;
      --df-messenger-bot-message-font-color: #4C3F30;
      --df-messenger-send-icon: #D4AF37;
      --df-messenger-font-family: "Arial", sans-serif;
      z-index: 999;
    }
  </style>
</head>
<body>

  <div id="leaf-container"></div>

  <!-- ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏±‡∏î (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô) -->
  <div id="video-section">
    <button class="close-video-btn" id="close-video-btn" title="‡∏õ‡∏¥‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠">√ó</button>

    <h3 class="video-title">
      üé¨ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤
    </h3>

    <p class="video-question">
      ‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞? ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏ä‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞
    </p>

    <button id="open-video-btn" class="open-video-btn">
      ‚ñ∂ ‡πÄ‡∏õ‡∏¥‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
    </button>

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏à‡∏£‡∏¥‡∏á ‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° -->
    <div id="video-frame-wrapper" class="video-collapsed">
      <div class="video-frame-inner">
        <iframe
          src="https://www.youtube.com/embed/66LNPaAWerk"
          title="‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen>
        </iframe>
      </div>
      <p class="video-caption">
        ‚ú® ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ô‡∏µ‡πâ‡∏Ñ‡πà‡∏∞
      </p>
    </div>
  </div>

  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö -->
  <div id="content-wrapper">
    <div id="nong-srivi-model">
      <div class="character-body"></div>
      <div class="character-head">
        <div class="character-eye left"></div>
        <div class="character-eye right"></div>
        <div class="character-smile"></div>
      </div>
    </div>

    <h1>‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h1>
    <p>‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏∏‡πÄ‡∏ó‡∏®‡∏Å‡πå AI ‡πÅ‡∏´‡πà‡∏á‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏∞</p>
    <p style="margin-top: 10px; color: #8B6914; font-size: 0.95em;">
      üí¨ ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞
    </p>
    <button id="start-chat-button">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏ô‡∏ó‡∏ô‡∏≤</button>
  </div>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö -->
  <button id="back-button">‚üµ ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>

  <!-- ‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡∏ö‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ä‡∏ó -->
  <div id="flying-srivi">
    <div class="flying-character-body"></div>
    <div class="flying-character-head">
      <div class="flying-character-eye left"></div>
      <div class="flying-character-eye right"></div>
      <div class="flying-character-smile"></div>
    </div>
  </div>

  <!-- ‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å ‡∏õ‡∏¥‡∏î‡∏ó‡∏±‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ä‡∏ó Dialogflow -->
  <div id="srivi-mini" aria-hidden="true">
    <div class="srivi-mini-body"></div>
    <div class="srivi-mini-head">
      <div class="srivi-mini-eye left"></div>
      <div class="srivi-mini-eye right"></div>
      <div class="srivi-mini-smile"></div>
    </div>
  </div>

  <!-- Dialogflow Messenger -->
  <script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
  <df-messenger
    chat-title="‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥ (AI Guide)"
    agent-id="2f3ad8d0-abd6-49dd-a7ac-ad9024c74e62"
    language-code="th"
    intent="WELCOME">
  </df-messenger>

  <script>
    /* ---------- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö (‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢) ---------- */
    let sriviVoice = null;

    function initSriviVoice() {
      if (!("speechSynthesis" in window)) return;
      const voices = window.speechSynthesis.getVoices();
      if (!voices || voices.length === 0) return;

      sriviVoice =
        voices.find(v =>
          v.lang.startsWith("th") &&
          /female|‡∏´‡∏ç‡∏¥‡∏á|Kanya|Thai Female/i.test(v.name)
        ) ||
        voices.find(v => v.lang.startsWith("th")) ||
        null;
    }

    if ("speechSynthesis" in window) {
      window.speechSynthesis.onvoiceschanged = initSriviVoice;
      initSriviVoice();
    }

    function speak(text) {
      if (!("speechSynthesis" in window)) {
        console.warn("‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö speechSynthesis");
        return;
      }
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "th-TH";
      if (sriviVoice) {
        utter.voice = sriviVoice;
      }
      utter.pitch = 1.1;
      utter.rate  = 1.0;

      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utter);
    }

    /* ---------- ‡πÉ‡∏ö‡πÑ‡∏°‡πâ‡∏£‡πà‡∏ß‡∏á ---------- */
    function createLeaves() {
      const container = document.getElementById('leaf-container');
      if (!container) return;

      const leafCount = 30;
      const colors = ['#D95B00', '#E25822', '#C34A2C', '#FF4500', '#DAA520'];

      for (let i = 0; i < leafCount; i++) {
        let leaf = document.createElement('span');
        leaf.className = 'leaf';
        leaf.innerHTML = 'üçÅ';
        leaf.style.left = Math.random() * 100 + 'vw';
        leaf.style.animationDuration = (Math.random() * 5) + 5 + 's';
        leaf.style.animationDelay = Math.random() * 5 + 's';
        leaf.style.fontSize = (Math.random() * 1) + 1 + 'em';
        leaf.style.color = colors[Math.floor(Math.random() * colors.length)];
        container.appendChild(leaf);
      }
    }

    /* ---------- ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πÑ‡∏ï‡∏•‡πå df-messenger ‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î ---------- */
    window.addEventListener("dfMessengerLoaded", function () {
      console.log("‚úÖ Dialogflow Messenger ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");

      const dfMessenger = document.querySelector('df-messenger');

      function styleChat() {
        if (!dfMessenger || !dfMessenger.shadowRoot) return;
        const shadow = dfMessenger.shadowRoot;

        // ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡∏ö‡∏≠‡∏ó: ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ 2.jpeg (‡πÑ‡∏°‡πà‡∏¢‡∏∏‡πà‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡πá‡∏ö)
        const chatWrapper = shadow.querySelector('.chat-wrapper');
        if (chatWrapper) {
          chatWrapper.style.backgroundImage = "url('2.jpeg')";
          chatWrapper.style.backgroundSize = "cover";
          chatWrapper.style.backgroundRepeat = "no-repeat";
          chatWrapper.style.backgroundPosition = "center center";
          chatWrapper.style.backgroundColor = "rgba(255,255,255,0.92)";
        }

        // tooltip ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á ‡πÜ
        const tooltip = shadow.querySelector('.df-messenger-tooltip, .df-tooltip');
        if (tooltip) {
          tooltip.style.backgroundColor = "rgba(255,255,255,0.95)";
        }
      }

      styleChat();
    });

    /* ---------- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏´‡∏•‡∏±‡∏á DOM ‡∏û‡∏£‡πâ‡∏≠‡∏° ---------- */
    setTimeout(function () {
      const startButton       = document.getElementById('start-chat-button');
      const contentWrapper    = document.getElementById('content-wrapper');
      const flyingSrivi       = document.getElementById('flying-srivi');
      const videoSection      = document.getElementById('video-section');
      const closeVideoBtn     = document.getElementById('close-video-btn');
      const openVideoBtn      = document.getElementById('open-video-btn');
      const videoFrameWrapper = document.getElementById('video-frame-wrapper');
      const backButton        = document.getElementById('back-button');
      const dfMessenger       = document.querySelector('df-messenger');

      // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏ô‡∏ó‡∏ô‡∏≤
      if (startButton && contentWrapper && flyingSrivi) {
        startButton.onclick = function () {
          // ‡∏û‡∏π‡∏î‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö
          speak("‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥ ‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏∏‡πÄ‡∏ó‡∏®‡∏Å‡πå‡πÄ‡∏≠‡πÑ‡∏≠‡πÅ‡∏´‡πà‡∏á‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ä‡∏¢‡∏≤ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞");

          // ‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö
          contentWrapper.classList.add('hidden');

          // ‡∏ô‡πâ‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡∏ö‡∏¥‡∏ô‡πÑ‡∏õ‡∏°‡∏∏‡∏°‡πÅ‡∏ä‡∏ó
          flyingSrivi.classList.add('flying');

          // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏ä‡∏ó
          setTimeout(function () {
            try {
              const chatWindow = dfMessenger.shadowRoot?.querySelector('.chat-wrapper');
              if (chatWindow) chatWindow.style.display = 'flex';
            } catch (e) {
              console.warn(e);
            }
          }, 1200);

          setTimeout(function () {
            flyingSrivi.classList.remove('flying');
            flyingSrivi.style.display = 'none';
          }, 2600);
        };
      }

      // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (‡πÇ‡∏ä‡∏ß‡πå iframe)
      if (openVideoBtn && videoFrameWrapper) {
        openVideoBtn.onclick = function () {
          videoFrameWrapper.classList.remove('video-collapsed');
          openVideoBtn.style.display = 'none';
        };
      }

      // ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
      if (closeVideoBtn && videoSection) {
        closeVideoBtn.onclick = function () {
          videoSection.classList.add('hidden');

          // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï iframe ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏¢‡∏∏‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
          const iframe = videoFrameWrapper?.querySelector('iframe');
          if (iframe) {
            const src = iframe.src;
            iframe.src = src;
          }
        };
      }

      // ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
      if (backButton) {
        backButton.onclick = function () {
          if (window.history.length > 1) {
            history.back();
          } else {
            window.location.href = "https://google.com";
          }
        };
      }

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡πÑ‡∏°‡πâ‡∏£‡πà‡∏ß‡∏á
      createLeaves();
    }, 500);
  </script>
</body>
</html>
